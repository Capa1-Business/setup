const translations = {
  en: {
    pageTitle: "CaPa's Writing house",
    navHome: "Home",
    navServices: "Services",
    navContact: "Contact",
    toggleTheme: "Toggle Theme",
    heroTitle: "Welcome to CaPa's Writing house",
    heroP1: "Your expert partner for crafting compelling Statements of Purpose, college/transfer/master/PhD essays, and professional Resumes.",
    heroP2: "Let us help you articulate your unique story and achieve your academic and career goals.",
    servicesTitle: "Our Services",
    serviceSoPTitle: "SoP & Essays",
    serviceSoPDesc: "Tailored writing for university admissions, including Statements of Purpose, Personal Statements, and various application essays. We highlight your achievements and aspirations effectively.",
    serviceResumeTitle: "Resume Building",
    serviceResumeDesc: "Professionally designed resumes and CVs that stand out to recruiters. We focus on showcasing your skills, experience, and potential.",
    whyChooseTitle: "Why Choose CaPa's Writing house?",
    whyChoose1: "Experienced writers specializing in academic and professional documents.",
    whyChoose2: "Personalized approach to capture your unique voice and story.",
    whyChoose3: "Proven track record of helping clients achieve their goals.",
    whyChoose4: "Timely delivery and competitive pricing.",
    howItWorksTitle: "How It Works",
    howItWorks1: "Submit your requirements and relevant documents.",
    howItWorks2: "Collaborate with your dedicated writer.",
    howItWorks3: "Receive a professionally crafted draft for review.",
    howItWorks4: "Finalize your document with revisions.",
    contactTitle: "Get in Touch",
    formNameLabel: "Your Name:",
    formEmailLabel: "Your Email:",
    formMessageLabel: "Your Message:",
    formSendButton: "Send",
    footerCopyright: "&copy; 2026 CaPa's Writing house. All rights reserved.",
    footerAbout: "About Us",
    footerPrivacy: "Privacy Policy",
    footerTerms: "Terms of Service"
  },
  ko: {
    pageTitle: "카파스 글쓰기 하우스",
    navHome: "홈",
    navServices: "서비스",
    navContact: "문의",
    toggleTheme: "테마 전환",
    heroTitle: "카파스 글쓰기 하우스에 오신 것을 환영합니다",
    heroP1: "매력적인 학업계획서(SoP), 대학교/편입/석사/박사 에세이 및 전문적인 이력서 작성을 위한 전문 파트너입니다.",
    heroP2: "저희는 여러분의 독특한 이야기를 명확하게 전달하고 학업 및 경력 목표를 달성하도록 돕습니다.",
    servicesTitle: "우리의 서비스",
    serviceSoPTitle: "SoP & 에세이",
    serviceSoPDesc: "학업계획서(SoP), 자기소개서 및 다양한 지원 에세이를 포함한 대학 입학을 위한 맞춤형 글쓰기. 여러분의 성과와 열망을 효과적으로 강조합니다.",
    serviceResumeTitle: "이력서 작성",
    serviceResumeDesc: "채용 담당자의 눈길을 사로잡는 전문적으로 디자인된 이력서 및 CV. 저희는 여러분의 기술, 경험 및 잠재력을 보여주는 데 중점을 둡니다.",
    whyChooseTitle: "카파스 글쓰기 하우스를 선택하는 이유",
    whyChoose1: "학술 및 전문 문서 전문 경험이 풍부한 작가.",
    whyChoose2: "여러분의 독특한 목소리와 이야기를 담아내는 맞춤형 접근 방식.",
    whyChoose3: "고객이 목표를 달성하도록 돕는 검증된 실적.",
    whyChoose4: "시기적절한 제공 및 경쟁력 있는 가격.",
    howItWorksTitle: "작동 방식",
    howItWorks1: "요구 사항 및 관련 문서를 제출합니다.",
    howItWorks2: "전담 작가와 협력합니다.",
    howItWorks3: "전문적으로 작성된 초안을 검토합니다.",
    howItWorks4: "수정 사항을 반영하여 문서를 마무리합니다.",
    contactTitle: "문의하기",
    formNameLabel: "이름:",
    formEmailLabel: "이메일:",
    formMessageLabel: "메시지:",
    formSendButton: "보내기",
    footerCopyright: "&copy; 2026 카파스 글쓰기 하우스. 모든 권리 보유.",
    footerAbout: "회사 소개",
    footerPrivacy: "개인 정보 처리 방침",
    footerTerms: "서비스 약관"
  },
  zh: {
    pageTitle: "卡帕斯写作之家",
    navHome: "首页",
    navServices: "服务",
    navContact: "联系",
    toggleTheme: "切换主题",
    heroTitle: "欢迎来到卡帕斯写作之家",
    heroP1: "您撰写引人注目的个人陈述(SoP)、大学/转学/硕士/博士论文和专业简历的专家合作伙伴。",
    heroP2: "让我们帮助您清晰地表达您的独特故事，实现您的学业和职业目标。",
    servicesTitle: "我们的服务",
    serviceSoPTitle: "SoP & 论文",
    serviceSoPDesc: "为大学入学量身定制的写作，包括个人陈述、个人论文和各种申请论文。我们有效地突出您的成就和抱负。",
    serviceResumeTitle: "简历制作",
    serviceResumeDesc: "专业设计的简历和求职信，让招聘人员眼前一亮。我们专注于展示您的技能、经验和潜力。",
    whyChooseTitle: "为什么选择卡帕斯写作之家？",
    whyChoose1: "拥有学术和专业文件专业知识的经验丰富的作家。",
    whyChoose2: "个性化方法，捕捉您独特的声音和故事。",
    whyChoose3: "帮助客户实现目标的良好记录。",
    whyChoose4: "及时交付和有竞争力的价格。",
    howItWorksTitle: "工作原理",
    howItWorks1: "提交您的要求和相关文件。",
    howItWorks2: "与您的专属作家协作。",
    howItWorks3: "收到专业撰写的草稿以供审查。",
    howItWorks4: "通过修改完成您的文档。",
    contactTitle: "联系我们",
    formNameLabel: "您的姓名:",
    formEmailLabel: "您的电子邮件:",
    formMessageLabel: "您的消息:",
    formSendButton: "发送",
    footerCopyright: "&copy; 2026 卡帕斯写作之家。保留所有权利。",
    footerAbout: "关于我们",
    footerPrivacy: "隐私政策",
    footerTerms: "服务条款"
  }
};

document.addEventListener('DOMContentLoaded', () => {
  const themeToggleButton = document.getElementById('theme-toggle');
  const htmlElement = document.documentElement;
  const languageSwitcher = document.getElementById('language-switcher');

  // Theme logic
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    htmlElement.setAttribute('data-theme', savedTheme);
  } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    htmlElement.setAttribute('data-theme', 'dark');
  } else {
    htmlElement.setAttribute('data-theme', 'light');
  }

  themeToggleButton.addEventListener('click', () => {
    let currentTheme = htmlElement.getAttribute('data-theme');
    let newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    htmlElement.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  });

  // Language logic
  const setLanguage = (lang) => {
    htmlElement.lang = lang; // Set the lang attribute on the html element
    document.querySelectorAll('[data-i18n]').forEach(element => {
      const key = element.getAttribute('data-i18n');
      if (translations[lang] && translations[lang][key]) {
        if (element.tagName === 'TITLE') {
          element.textContent = translations[lang][key];
        } else if (element.tagName === 'INPUT' && element.type === 'submit') {
          element.value = translations[lang][key];
        } else {
          element.textContent = translations[lang][key];
        }
      }
    });

    // Update legal page links
    const legalLinks = document.querySelectorAll('.footer-nav a');
    legalLinks.forEach(link => {
      const originalHref = link.getAttribute('href').split('?')[0]; // Remove existing query params
      link.setAttribute('href', `${originalHref}?lang=${lang}`);
    });

    localStorage.setItem('lang', lang);
  };

  // Initialize language
  const savedLang = localStorage.getItem('lang') || navigator.language.split('-')[0] || 'en';
  languageSwitcher.value = savedLang;
  setLanguage(savedLang);

  languageSwitcher.addEventListener('change', (event) => {
    setLanguage(event.target.value);
  });

  // Set initial language for legal pages
  // This is redundant as setLanguage is called on load, but good for clarity
  const initialLang = localStorage.getItem('lang') || 'en';
  document.querySelectorAll('.footer-nav a').forEach(link => {
    const originalHref = link.getAttribute('href').split('?')[0];
    link.setAttribute('href', `${originalHref}?lang=${initialLang}`);
  });
});